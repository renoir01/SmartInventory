{% extends 'base.html' %}

{% block title %}Cashier Dashboard - Smart Inventory{% endblock %}

{% block content %}
<h1>Cashier Dashboard</h1>

<div class="dashboard-widgets">
    <div class="widget">
        <h3 class="widget-title">Today's Sales</h3>
        <div class="widget-value">{{ today_sales|length }}</div>
        <p class="widget-description">Sales you've made today</p>
    </div>
    
    <div class="widget">
        <h3 class="widget-title">Today's Revenue</h3>
        <div class="widget-value">RWF {{ "%.0f"|format(total_revenue) }}</div>
        <p class="widget-description">Revenue you've generated today</p>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2>Record New Sale</h2>
    </div>
    <div class="card-body">
        <form method="POST" action="{{ url_for('sell_product') }}">
            <div class="form-group">
                <label for="product_id" class="form-label">Select Product</label>
                <select id="product_id" name="product_id" class="form-control" required>
                    <option value="">-- Select a product --</option>
                    {% for product in products %}
                    <option value="{{ product.id }}">
                        {{ product.name }} - RWF {{ "%.0f"|format(product.price) }} ({{ product.stock }} in stock)
                    </option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group">
                <label for="quantity" class="form-label">Quantity</label>
                <input type="number" id="quantity" name="quantity" class="form-control" min="1" value="1" required>
            </div>
            
            <div class="form-group">
                <button type="submit" class="btn btn-success">Record Sale</button>
            </div>
        </form>
    </div>
</div>

<div class="card mt-3">
    <div class="card-header">
        <h2>Today's Sales</h2>
    </div>
    <div class="card-body">
        {% if today_sales|length > 0 %}
        <table class="table">
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Price</th>
                </tr>
            </thead>
            <tbody>
                {% for sale in today_sales %}
                <tr>
                    <td>{{ sale.date_sold.strftime('%H:%M:%S') }}</td>
                    <td>{{ sale.product.name }}</td>
                    <td>{{ sale.quantity }}</td>
                    <td>RWF {{ "%.0f"|format(sale.total_price) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>You haven't recorded any sales today.</p>
        {% endif %}
    </div>
    <div class="card-footer">
        <a href="{{ url_for('view_cashier_sales') }}" class="btn btn-primary">View All My Sales</a>
    </div>
</div>
{% endblock %}
